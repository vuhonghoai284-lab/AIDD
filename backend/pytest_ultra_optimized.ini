[tool:pytest]
# 超优化的pytest配置 - 专注速度和稳定性
testpaths = tests
python_files = test_*.py
python_classes = Test*
python_functions = test_*
asyncio_mode = auto

# 极速优化配置
addopts = 
    --tb=short
    --disable-warnings
    --strict-markers
    --color=yes
    --maxfail=10
    --durations=5
    --durations-min=2.0
    -x
    --no-header
    --no-summary
    -q

# 标记定义 - 重新组织
markers =
    # 速度分级
    fast: 超快速测试 (< 1s)
    medium: 中速测试 (1-5s)
    slow: 慢速测试 (> 5s)
    
    # 功能分级  
    unit: 单元测试 (isolated)
    integration: 集成测试 (with dependencies)
    e2e: 端到端测试 (full workflow)
    
    # 可靠性分级
    stable: 稳定测试 (always pass)
    unstable: 不稳定测试 (may fail)
    broken: 已知损坏的测试
    
    # 业务模块
    auth: 认证相关
    task: 任务相关
    user: 用户相关
    system: 系统相关
    api: API接口
    
    # 测试类型
    smoke: 冒烟测试
    regression: 回归测试
    performance: 性能测试
    stress: 压力测试
    security: 安全测试

# 过滤警告
filterwarnings =
    ignore::DeprecationWarning
    ignore::PendingDeprecationWarning
    ignore::UserWarning:sqlalchemy.*
    ignore::pytest.PytestUnknownMarkWarning
    ignore::RuntimeWarning
    
# 最小版本要求
minversion = 6.0

# 并行执行配置（可选）
# 如果安装了pytest-xdist，取消注释下面的配置
# addopts = 
#     -n auto
#     --dist worksteal